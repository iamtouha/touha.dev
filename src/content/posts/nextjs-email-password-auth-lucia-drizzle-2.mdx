---
title: "Nextjs Email Password Authentication with Lucia and Drizzle: Part 2"
description:
  "In this part we'll add the ability to signup and login with email and
  password using lucia and drizzle"
read: "10 min read"
date: 2023-12-14
published: true
featured: true
---

In the [previous part](/posts/nextjs-email-password-auth-lucia-drizzle-1) we set
up the basic structure of our app. In this part we'll add the ability to sign up
and log in with email and password.

### Sign up

Now that we have our basic structure set up, we can start adding functionality.
Let's start with the sign up page.

We'll use nextjs
[router group](https://nextjs.org/docs/app/building-your-application/routing/route-groups)
to separate the auth pages from the rest of the app.

At first,create a form wrapper component in `src/components/form.tsx` that will
use javascript to handle the redirect responses.

```tsx
"use client";

import { useRouter } from "next/navigation";

export const Form = ({
  children,
  action,
}: {
  children: React.ReactNode;
  action: string;
}) => {
  const router = useRouter();
  return (
    <form
      action={action}
      method="post"
      onSubmit={async (e) => {
        e.preventDefault();
        const formData = new FormData(e.currentTarget);
        const response = await fetch(action, {
          method: "POST",
          body: formData,
          redirect: "manual",
        });

        if (response.status === 0) return router.refresh();
      }}
    >
      {children}
    </form>
  );
};
```

Create a new file `src/app/(auth)/signup/page.tsx` and add a form with inputs
for username and password. The form should make a POST request to
`/api/auth/signup`.

```tsx
// src/app/(auth)/signup/page.tsx
import { Form } from "@/components/form";

export const metadata = {
  title: "Signup",
  description: "Signup Page",
};

export default function SignupPage() {
  return (
    <main className="p-4">
      <div className="w-80 mx-auto">
        <h1 className="font-bold text-center">Signup Page</h1>
        <Form action="/api/auth/signup">
          <div className="space-y-3 mt-12">
            <div className="flex flex-col space-y-2">
              <label htmlFor="email">Email</label>
              <input
                type="email"
                id="email"
                name="email"
                required
                className="border-2 px-2 py-1 rounded"
              />
            </div>
            <div className="flex flex-col space-y-2">
              <label htmlFor="password">Password</label>
              <input
                type="password"
                id="password"
                name="password"
                required
                minLength={8}
                className="border-2 px-2 py-1 rounded"
              />
            </div>
            <button
              type="submit"
              className="bg-blue-500 text-white rounded px-4 py-2"
            >
              Signup
            </button>
          </div>
        </Form>
      </div>
    </main>
  );
}
```
