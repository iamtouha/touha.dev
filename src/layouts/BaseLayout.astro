---
import { SEO } from "astro-seo";

import "../styles/globals.css";

interface Props {
  title: string;
  description?: string;
  image?: string;
  type?: string;
}
const { title, description, image, type } = Astro.props;
---

<script is:inline>
  const getThemePreference = () => {
    if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
      return localStorage.getItem("theme");
    }
    return window.matchMedia("(prefers-color-scheme: dark)").matches
      ? "dark"
      : "light";
  };
  const isDark = getThemePreference() === "dark";
  document.documentElement.classList[isDark ? "add" : "remove"]("dark");

  // if (typeof localStorage !== "undefined") {
  //   const observer = new MutationObserver(() => {
  //     const isDark = document.documentElement.classList.contains("dark");
  //     localStorage.setItem("theme", isDark ? "dark" : "light");
  //   });
  //   observer.observe(document.documentElement, {
  //     attributes: true,
  //     attributeFilter: ["class"],
  //   });
  // }
</script>

<html lang="en">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="utf-8" />
  <SEO
    title={title}
    titleTemplate="%s | Touha"
    description={description}
    openGraph={{
      basic: {
        title,
        type: type ?? "webpage",
        image: image ?? "/api/og.png",
      },
      image: image
        ? { url: image, width: 1200, height: 630, alt: title }
        : undefined,
    }}
  />
  <link rel="icon" href="/favicon.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link rel="sitemap" href="/sitemap-index.xml" />

  <body>
    <slot />
    <!-- <ViewTransitions /> -->
  </body>
</html>
